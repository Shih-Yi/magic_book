<div class="col-4">
  <div class='nested-fields'>
    <h6>繪本第<span class="page-counter"><span>頁</h6>
    <!-- image -->
    <div class="form-group">
      <label class="uploader">
        <span class="icon"><i class="fas fa-upload fa-2x"></i></span>
        <span class="placeholder">
          <% if f.object.image.present? %>
            已上傳檔案 <%= link_to f.object.image.identifier, f.object.image.url, :target => "_blank" %>
          <% else %>
            請上傳檔案
          <% end %>
        </span>
        <%= f.file_field :image, :class => "form-control" %>
      </label>
    </div>
    <!-- description -->
    <div class="form-group">
      <h6>第<span class="page-des-counter"><span>頁簡介</h6>
      <%= f.text_area :description, class: 'form_field form-area' %>
    </div>
    <%= link_to_remove_association "刪除此繪本檔案", f %>
    <br/>
    <hr/>
  </div>
</div>

<script>
  document.querySelectorAll('.uploader input[type="file"]').forEach((el) =>
    el.addEventListener("change", (ev) => {
      if (ev.target.files && ev.target.files.length) {
        const text = Array.from(ev.target.files)
          .map((x) => x.name)
          .join(", ");
        el.parentNode.querySelector(".placeholder").innerText = text;
      }
    })
  );
</script>
